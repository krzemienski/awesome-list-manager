"use strict";(()=>{var e={};e.id=594,e.ids=[594],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},7561:e=>{e.exports=require("node:fs")},4492:e=>{e.exports=require("node:stream")},2477:e=>{e.exports=require("node:stream/web")},1017:e=>{e.exports=require("path")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},1267:e=>{e.exports=require("worker_threads")},9796:e=>{e.exports=require("zlib")},7985:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>k,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>q});var i={};r.r(i),r.d(i,{GET:()=>d,POST:()=>p});var s=r(5419),o=r(9108),n=r(9678),a=r(8070),l=r(7699),u=r(2455),c=r(8105);async function p(e,{params:t}){try{let r=(0,l.createRouteHandlerClient)({cookies:u.cookies}),{listId:i}=t,{data:{session:s}}=await r.auth.getSession();if(!s)return a.Z.json({error:"Unauthorized"},{status:401});let{url:o,category_id:n,title:p,description:d}=await e.json();if(!o)return a.Z.json({error:"URL is required"},{status:400});let{data:g}=await r.from("lists").select("user_id").eq("id",t.listId).single();if(!g||g.user_id!==s.user.id)return a.Z.json({error:"Unauthorized"},{status:401});let m=n,{data:x}=await r.from("user_settings").select("openai_api_key, auto_categorize").eq("user_id",s.user.id).single(),h=[];if(x?.openai_api_key&&x?.auto_categorize&&!n&&(c.bc(x.openai_api_key),(h=await c.SQ(o,p||"",d||"")).length>0)){let{data:e}=await r.from("categories").select("id").eq("list_id",i).ilike("name",h[0]).single();e&&(m=e.id)}let{data:f,error:q}=await r.from("links").insert({list_id:t.listId,category_id:m,title:p,url:o,description:d}).select().single();if(q)throw q;return a.Z.json({...f,suggested_categories:h})}catch(e){return console.error("Error creating link:",e),a.Z.json({error:"Internal server error"},{status:500})}}async function d(e,{params:t}){try{let e=(0,l.createRouteHandlerClient)({cookies:u.cookies}),{data:r,error:i}=await e.from("links").select(`
        *,
        category:categories(
          id,
          name
        )
      `).eq("list_id",t.listId).order("category_id",{ascending:!0}).order("order",{ascending:!0});if(i)throw i;return a.Z.json(r)}catch(e){return console.error("Error fetching links:",e),a.Z.json({error:"Internal server error"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/lists/[listId]/links/route",pathname:"/api/lists/[listId]/links",filename:"route",bundlePath:"app/api/lists/[listId]/links/route"},resolvedPagePath:"/Users/nick/Desktop/alm/src/app/api/lists/[listId]/links/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:h,headerHooks:f,staticGenerationBailout:q}=g,k="/api/lists/[listId]/links/route";function w(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},8105:(e,t,r)=>{r.d(t,{SQ:()=>n,bc:()=>o,xe:()=>a});var i=r(5185);let s=null;function o(e){s=new i.ZP({apiKey:e})}async function n(e,t,r){if(!s)throw Error("OpenAI client not initialized");let i=`Given this resource:
URL: ${e}
Title: ${t}
Description: ${r}

Suggest up to 3 appropriate categories for this resource in an awesome list. Return only the category names, one per line.`,o=await s.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:i}],temperature:.7,max_tokens:100});return o.choices[0].message.content?.split("\n").filter(Boolean)||[]}async function a(e){if(!s)throw Error("OpenAI client not initialized");let t=`Given this URL: ${e}

Suggest 3 related resources that would be good additions to an awesome list. Return them in this format:
Title: [title]
URL: [url]
Description: [brief description]

---`;return((await s.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:t}],temperature:.7,max_tokens:500})).choices[0].message.content||"").split("---").filter(Boolean).map(e=>{let t=e.trim().split("\n");return{title:t[0].replace("Title:","").trim(),url:t[1].replace("URL:","").trim(),description:t[2].replace("Description:","").trim()}})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[225,280,185],()=>r(7985));module.exports=i})();